
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>peclet documentation</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-12-21"><meta name="DC.source" content="peclet_documentation.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1><tt>peclet</tt> documentation</h1><!--introduction--><p><tt>peclet</tt> calculates the Peclet number along a glacier flowline using the formulation by Felikson et al., 2017.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Example 1</a></li><li><a href="#9">Example 2: Exploring m</a></li><li><a href="#10">Example 3: Effects of smoothing</a></li><li><a href="#11">Citing this function</a></li><li><a href="#12">Author Info</a></li></ul></div><h2 id="1">Syntax</h2><pre>Pe = peclet(d,thck,sfz)
Pe = peclet(...,'m',m)
Pe = peclet(...,'CouplingLength',Nthck)
Pe = peclet(...,'endpoints','fill')</pre><h2 id="2">Description</h2><p><tt>Pe = peclet(d,thck,sfz)</tt> returns the Peclet number along a glacier flowline where <tt>d</tt> is distance along the flowline in meters, and <tt>thck</tt> and <tt>sfz</tt> are the corresponding thickness and surface elevation in meters. The dimensions of <tt>d</tt>, <tt>thck</tt>, and <tt>sfz</tt> must all match. Tip: You can use <tt>pathdistps</tt> or <tt>pathdistpsn</tt> to get the distance along the flowline <tt>d</tt> in meters.</p><p><tt>Pe = peclet(...,'m',m)</tt> specifies a positive exponent m that relates to basal sliding (see Supp. Eq. 4 of Felikson et al., 2017.). By default, <tt>m = 1</tt>.</p><p><tt>Pe = peclet(...,'CouplingLength',Nthck)</tt> specifies a longitudinal coupling length as a multiple of ice thickesses. This is equivalent to l/H in Kamb &amp; Echelmeyer's  paper cited below. Important: <tt>Nthick</tt> is not the same thing as the total window width. The Kamb &amp; Echelmeyer paper describes it in detail, but the "averaging length" is the full width of a boxcar window and is equal to 4*l. In this function, the default value of <tt>Nthck</tt> is 2.5, which is equivalent to a moving average window width of 10 ice thicknesses.</p><div><ul><li>For guidance on choosing a value of <tt>Nthck</tt>, Kamb &amp; Echelmeyer state that   "l/H ranges from about 1.5 to 10...for temperate valley glaciers, with f   near 0.5 and with longitudinal strain-rates typically of order 0.01-0.05 /yr,   l/H should be in the range from about 1 to 3, whereas for ice sheets ...   the expected l/H is in the range from about 4 to 10, distinctly higher   than for valley glaciers."</li></ul></div><p><tt>Pe = peclet(...,'endpoints','fill')</tt> sets endpoints to <tt>NaN</tt> when performing the moving window average on the thickness and surface profiles, in a manner equivalent to the <tt>'fill'</tt> option in the <tt>movmean</tt> function. By default, the moving window shrinks at each end, to provide continuous measurements at the edges. This option will result in missing data at each end of the profile, as well as near each NaN datapoint.</p><h2 id="3">Example 1</h2><p>For this example, load <tt>Kangilerngata_Sermia_flowline.mat</tt>, which contains north polar stereographic coordinates <tt>xfl,yfl</tt>. If you have my MODIS Mosaic of Greenland function installed, you can take a look that the profile in map view like this, but don't worry about it if you don't have <tt>modismog</tt>.</p><pre class="codeinput">load <span class="string">Kangilerngata_Sermia_flowline</span>

figure
plot(xfl,yfl)
modismog(<span class="string">'contrast'</span>,<span class="string">'white'</span>)
xlabel <span class="string">'easting (m)'</span>
ylabel <span class="string">'northing (m)'</span>
</pre><img vspace="5" hspace="5" src="peclet_documentation_01.png" alt=""> <p>You'll need my functions for Mathieu Morlighem's BedMachine data to get the thickness and surface slope, so we might as well take a look at the profile down this glacier too. Use the <tt>pathdistpsn</tt> function to get an array of distance in meters along the flowline. That will be our common horizontal axis reference:</p><pre class="codeinput">dfl = pathdistpsn(xfl,yfl);

figure
subplot(2,1,1)
bedmachine_profile(xfl,yfl,<span class="string">'horiz'</span>,dfl/1000,<span class="string">'greenland'</span>)
xlabel <span class="string">'distance along profile (km)'</span>
ylabel <span class="string">'elevation wrt geoid (m)'</span>
</pre><img vspace="5" hspace="5" src="peclet_documentation_02.png" alt=""> <p>Now use <tt>bedmachine_interp</tt> to get thickness and surface elevation along the flowline, and calculate the Peclet number:</p><pre class="codeinput">H = bedmachine_interp(<span class="string">'thickness'</span>,xfl,yfl,<span class="string">'greenland'</span>);
sfz = bedmachine_interp(<span class="string">'surface'</span>,xfl,yfl,<span class="string">'greenland'</span>);

Pe = peclet(dfl,H,sfz);

subplot(2,1,2)
plot(dfl/1000,Pe)
axis <span class="string">tight</span>
box <span class="string">off</span>
xlabel <span class="string">'distance along profile (km)'</span>
ylabel <span class="string">'Pe'</span>
</pre><img vspace="5" hspace="5" src="peclet_documentation_03.png" alt=""> <p>In the profile above, we took the calculation all the way to the edges of the profile, even though we're smoothing using a window spanning several ice thicknesses. This means that we might not actually want to trust the data within a couple of ice thicknesses of either edge of the profile.</p><p>To eliminate any potential contamination from the edge effects of the filter, use the <tt>'endpoints','fill'</tt> option:</p><pre class="codeinput">Pe = peclet(dfl,H,sfz,<span class="string">'Endpoints'</span>,<span class="string">'fill'</span>);

hold <span class="string">on</span>
plot(dfl/1000,Pe,<span class="string">'linewidth'</span>,2)
</pre><img vspace="5" hspace="5" src="peclet_documentation_04.png" alt=""> <p>Felikson et al found that the inland extent of thinning relates to the cumulative maximum of the Peclet number. Signals don't tend to travel upstream further than where the running maximum Peclet number exceeds about 3. So for the <tt>Pe</tt> we calculated above, let's plot the running maximum:</p><pre class="codeinput">plot(dfl/1000,cummax(Pe),<span class="string">'linewidth'</span>,2)
</pre><img vspace="5" hspace="5" src="peclet_documentation_05.png" alt=""> <p>Sure enough, according to the Felikson paper, the thinning signal dies out around the location where the bed slope rises and the running maximum of the Peclet number exceeds 3.</p><h2 id="9">Example 2: Exploring m</h2><p>What is the meaning of the exponent m? It's related to basal sliding, and nobody's really sure what value to use, so we tend to play around with values between 1 and 3. Here's how a Peclet profile varies as a function of m.</p><p>Start by defining an array of values of m between 1 and 3. Define a corresponding colormap and loop through each value of m, calculating and plotting the Peclet number for each value of m:</p><pre class="codeinput">m = 1:0.1:3;
cm = parula(length(m));

figure
hold <span class="string">on</span>
<span class="keyword">for</span> k = 1:length(m)
   Pe = peclet(dfl,H,sfz,<span class="string">'m'</span>,m(k),<span class="string">'endpoints'</span>,<span class="string">'fill'</span>);
   plot(dfl/1000,Pe,<span class="string">'color'</span>,cm(k,:))
<span class="keyword">end</span>

box <span class="string">off</span>
xlabel <span class="string">'distance along profile (km)'</span>
ylabel <span class="string">'Pe'</span>
axis <span class="string">tight</span>

<span class="comment">% Manually set a colormap even though it's not actually linked to values m:</span>
cb = colorbar(<span class="string">'location'</span>,<span class="string">'north'</span>);
cb.Position = [cb.Position(1:2) cb.Position(3:4)/3];
cb.XAxisLocation = <span class="string">'top'</span>;
colormap(cm)
xlabel(cb,<span class="string">'exponent m'</span>)
caxis([1 3])
</pre><img vspace="5" hspace="5" src="peclet_documentation_06.png" alt=""> <h2 id="10">Example 3: Effects of smoothing</h2><p>As above, but</p><pre class="codeinput">Nthick = 0:10;
cm = parula(length(Nthick));

figure
hold <span class="string">on</span>
<span class="keyword">for</span> k = 1:length(Nthick)
   Pe = peclet(dfl,H,sfz,<span class="string">'CouplingLength'</span>,Nthick(k),<span class="string">'endpoints'</span>,<span class="string">'fill'</span>);
   plot(dfl/1000,Pe,<span class="string">'color'</span>,cm(k,:))
<span class="keyword">end</span>

box <span class="string">off</span>
xlabel <span class="string">'distance along profile (km)'</span>
ylabel <span class="string">'Pe'</span>
axis <span class="string">tight</span>

cb = colorbar(<span class="string">'location'</span>,<span class="string">'north'</span>);
cb.Position = [cb.Position(1:2) cb.Position(3:4)/3];
cb.XAxisLocation = <span class="string">'top'</span>;
colormap(cm)
xlabel(cb,<span class="string">'N thickness coupling length'</span>)
caxis([0 10])
</pre><img vspace="5" hspace="5" src="peclet_documentation_07.png" alt=""> <h2 id="11">Citing this function</h2><p>The formulas in this function are taken directly from Felikson et al., 2017, so if you use this function, please cite Denis' paper! And at least for accountability's sake, it's probably prudent to cite my Antarctic Mapping Tools paper too. Here are the citations:</p><p>Felikson, Denis, Timothy C. Bartholomaus, Ginny A. Catania, Niels J. Korsgaard, Kurt H. Kj&aelig;r, Mathieu Morlighem, Brice No&euml;l et al. "Inland thinning on the Greenland ice sheet controlled by outlet glacier geometry." Nature Geoscience 10, no. 5 (2017): 366-369. <a href="https://doi.org/10.1038/ngeo2934">https://doi.org/10.1038/ngeo2934</a></p><p>Greene, C. A., Gwyther, D. E., &amp; Blankenship, D. D. Antarctic Mapping Tools for Matlab. Computers &amp; Geosciences. 104 (2017) pp.151-157. <a href="http://dx.doi.org/10.1016/j.cageo.2016.08.003">http://dx.doi.org/10.1016/j.cageo.2016.08.003</a></p><h2 id="12">Author Info</h2><p>This function and supporting documentation were written by Chad A. Greene of NASA Jet Propulsion Laboratory. December 2020.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% |peclet| documentation 
% |peclet| calculates the Peclet number along a glacier flowline using the 
% formulation by Felikson et al., 2017.
% 
%% Syntax 
% 
%  Pe = peclet(d,thck,sfz)
%  Pe = peclet(...,'m',m)
%  Pe = peclet(...,'CouplingLength',Nthck) 
%  Pe = peclet(...,'endpoints','fill') 
%  
%% Description
% 
% |Pe = peclet(d,thck,sfz)| returns the Peclet number along a glacier flowline
% where |d| is distance along the flowline in meters, and |thck| and |sfz| are the 
% corresponding thickness and surface elevation in meters. The dimensions of 
% |d|, |thck|, and |sfz| must all match. Tip: You can use |pathdistps| or |pathdistpsn| 
% to get the distance along the flowline |d| in meters. 
% 
% |Pe = peclet(...,'m',m)| specifies a positive exponent m that relates to basal
% sliding (see Supp. Eq. 4 of Felikson et al., 2017.). By default, |m = 1|.
% 
% |Pe = peclet(...,'CouplingLength',Nthck)| specifies a longitudinal 
% coupling length as a multiple of ice thickesses. This is equivalent to l/H
% in Kamb & Echelmeyer's  paper cited below. Important: |Nthick| is not the same 
% thing as the total window width. The Kamb & Echelmeyer paper describes it 
% in detail, but the "averaging length" is the full width of a boxcar window 
% and is equal to 4*l. In this function, the default value of |Nthck| is 2.5, 
% which is equivalent to a moving average window width of 10 ice thicknesses. 
% 
% * For guidance on choosing a value of |Nthck|, Kamb & Echelmeyer state that
%   "l/H ranges from about 1.5 to 10...for temperate valley glaciers, with f 
%   near 0.5 and with longitudinal strain-rates typically of order 0.01-0.05 /yr, 
%   l/H should be in the range from about 1 to 3, whereas for ice sheets ...
%   the expected l/H is in the range from about 4 to 10, distinctly higher
%   than for valley glaciers."
% 
% |Pe = peclet(...,'endpoints','fill')| sets endpoints to |NaN| when performing  
% the moving window average on the thickness and surface profiles, in a manner
% equivalent to the |'fill'| option in the |movmean| function. By default, the 
% moving window shrinks at each end, to provide continuous measurements at the
% edges. This option will result in missing data at each end of the profile, as
% well as near each NaN datapoint. 
% 
%% Example 1 
% For this example, load |Kangilerngata_Sermia_flowline.mat|, which contains
% north polar stereographic coordinates |xfl,yfl|. If you have my MODIS Mosaic
% of Greenland function installed, you can take a look that the profile in map
% view like this, but don't worry about it if you don't have |modismog|. 

load Kangilerngata_Sermia_flowline 

figure
plot(xfl,yfl)
modismog('contrast','white') 
xlabel 'easting (m)' 
ylabel 'northing (m)'

%% 
% You'll need my functions for Mathieu Morlighem's BedMachine data to get
% the thickness and surface slope, so we might as well take a look at the 
% profile down this glacier too. Use the |pathdistpsn| function to get 
% an array of distance in meters along the flowline. That will be our common
% horizontal axis reference: 

dfl = pathdistpsn(xfl,yfl); 

figure
subplot(2,1,1) 
bedmachine_profile(xfl,yfl,'horiz',dfl/1000,'greenland') 
xlabel 'distance along profile (km)' 
ylabel 'elevation wrt geoid (m)'

%% 
% Now use |bedmachine_interp| to get thickness and surface elevation 
% along the flowline, and calculate the Peclet number: 

H = bedmachine_interp('thickness',xfl,yfl,'greenland'); 
sfz = bedmachine_interp('surface',xfl,yfl,'greenland'); 

Pe = peclet(dfl,H,sfz); 

subplot(2,1,2) 
plot(dfl/1000,Pe)
axis tight 
box off
xlabel 'distance along profile (km)' 
ylabel 'Pe' 

%% 
% In the profile above, we took the calculation all the way to the edges 
% of the profile, even though we're smoothing using a window spanning several 
% ice thicknesses. This means that we might not actually want to trust the data 
% within a couple of ice thicknesses of either edge of the profile. 
% 
% To eliminate any potential contamination from the edge effects of the filter, 
% use the |'endpoints','fill'| option: 

Pe = peclet(dfl,H,sfz,'Endpoints','fill'); 

hold on
plot(dfl/1000,Pe,'linewidth',2)

%% 
% Felikson et al found that the inland extent of thinning relates to the cumulative
% maximum of the Peclet number. Signals don't tend to travel upstream further than 
% where the running maximum Peclet number exceeds about 3. So for the |Pe| we calculated 
% above, let's plot the running maximum: 

plot(dfl/1000,cummax(Pe),'linewidth',2)

%% 
% Sure enough, according to the Felikson paper, the thinning signal dies out around 
% the location where the bed slope rises and the running maximum of the Peclet
% number exceeds 3. 

%% Example 2: Exploring m 
% What is the meaning of the exponent m? It's related to basal sliding, and 
% nobody's really sure what value to use, so we tend to play around with values
% between 1 and 3. Here's how a Peclet profile varies as a function of m. 
% 
% Start by defining an array of values of m between 1 and 3. Define a 
% corresponding colormap and loop through each value of m, calculating and
% plotting the Peclet number for each value of m: 

m = 1:0.1:3; 
cm = parula(length(m)); 

figure
hold on
for k = 1:length(m) 
   Pe = peclet(dfl,H,sfz,'m',m(k),'endpoints','fill'); 
   plot(dfl/1000,Pe,'color',cm(k,:))
end

box off
xlabel 'distance along profile (km)'
ylabel 'Pe' 
axis tight

% Manually set a colormap even though it's not actually linked to values m:
cb = colorbar('location','north');
cb.Position = [cb.Position(1:2) cb.Position(3:4)/3]; 
cb.XAxisLocation = 'top'; 
colormap(cm)
xlabel(cb,'exponent m') 
caxis([1 3])

%% Example 3: Effects of smoothing
% As above, but 

Nthick = 0:10; 
cm = parula(length(Nthick)); 

figure
hold on
for k = 1:length(Nthick) 
   Pe = peclet(dfl,H,sfz,'CouplingLength',Nthick(k),'endpoints','fill'); 
   plot(dfl/1000,Pe,'color',cm(k,:))
end

box off
xlabel 'distance along profile (km)'
ylabel 'Pe' 
axis tight

cb = colorbar('location','north');
cb.Position = [cb.Position(1:2) cb.Position(3:4)/3]; 
cb.XAxisLocation = 'top'; 
colormap(cm)
xlabel(cb,'N thickness coupling length') 
caxis([0 10])

%% Citing this function 
% The formulas in this function are taken directly from Felikson et al., 
% 2017, so if you use this function, please cite Denis' paper! And at least 
% for accountability's sake, it's probably prudent to cite my Antarctic Mapping 
% Tools paper too. Here are the citations: 
% 
% Felikson, Denis, Timothy C. Bartholomaus, Ginny A. Catania, Niels J. Korsgaard,
% Kurt H. Kjær, Mathieu Morlighem, Brice Noël et al. "Inland thinning on the Greenland 
% ice sheet controlled by outlet glacier geometry." Nature Geoscience 10, no. 5 
% (2017): 366-369. <https://doi.org/10.1038/ngeo2934>
% 
% Greene, C. A., Gwyther, D. E., & Blankenship, D. D. Antarctic Mapping Tools for Matlab. 
% Computers & Geosciences. 104 (2017) pp.151-157. 
% <http://dx.doi.org/10.1016/j.cageo.2016.08.003>
%
%% Author Info
% This function and supporting documentation were written by Chad A. Greene
% of NASA Jet Propulsion Laboratory. December 2020. 
##### SOURCE END #####
--></body></html>